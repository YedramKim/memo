---
title: 언리얼-공부-3
date: 2020-04-05 23:39:16
tags:
---

## 애니메이션 블루 프린트
- 애니메이션 시스템을 체계적으로 설계하도록 언리얼 엔진에서 제공하는 애니메이션 시스템.
- 애니메이션 블루프린트는 애님 그래프 로직에 따라 동작하는 캐릭터 애니메이션 시스템을 구동시키는데, 이러한 애니메이션 시스템은 애님 인스턴스(`AnimInstance`)라는 클래스로 관리된다.
	- 애님 인스턴스: 스켈레탈 메시를 소유하는 폰의 정보를 받아 애님 그래프가 참조할 데이터를 제공하는 객체. C++과 블루 프린트로 제작할 수 있다.
  - 애님 그래프: 애님 인스턴스의 변수 값에 따라 변화하는 애니메이션 시스템을 설계하는 공간.
- 작성한 애님 그래프는 `애님 프리뷰 에디터` 윈도우를 통해서 애님 인스턴스의 데이터를 바꾸는 것으로 테스트를 해볼 수 있다.

### 애님 인스턴스
- 애님 인스턴스를 상속한 객체의 멤버 변수를 블루프린트에서 접근하도록 하는 UPROPERTY 키워드는 BlueprintReadOnly, BlueprintReadWrite가 있다.
- 애님 인스턴스는 블루 프린트의 클래스 세팅의 부모 클래스에서 변경할 수 있다.
```C++
UPROPERTY(EditAnywhere, BlueprintReadOnly)
UPROPERTY(EditAnywhere, BlueprintReadWrite)
```
- UAnimInstance::NativeUpdateAnimation(float DeltaSeconds): 틱마다 호출 되는 애님 인스턴스의 가상함수
  - 게임 엔진은 틱마다 입력 시스템 -> 게임 로직 -> 애니메이션 시스템 순으로 로직을 실행한다.
- UAnimInstance::TryGetPawnOwner: 애님 인스턴스를 사용하는 폰을 반환한다.

## 무브먼트 컴포넌트를 통한 점프 기능의 구현
- ACharacter 클래스에는 Jump라는 멤버함수가 구현되어 있다.
- 캐릭터 무브먼트 컴포넌트의 기능 중 하나가 점프 구현이 용이하다는 점이다.
  - 컴포넌트의 값 중 JumpZVelocity라는 값을 통해 점프의 높이를 조절할 수 있다.
- 폰 무브먼트 컴포넌트에는 현재의 움직임을 파악하기 위한 함수들을 제공하고 있다. 폰 무브먼트에서 해당 함수들은 설계만 되어있을 뿐 제대로 구현한 컴포넌트는 캐릭터 무브먼트 컴포넌트 뿐이다.
  1. IsFalling(): 현재 공중에 떠있는가.
  2. IsSwimming(): 현재 수영 중인가.
  3. IsCrouching(): 현재 쭈그리고 있는가.
  4. IsMoveOnGround(): 현재 땅 위에서 이동중인가.

## 애니메이션 리타겟
- 언리얼 엔진은 인간형 캐릭터의 경우 스켈레톤의 구성이 달라도 애니메이션을 교환할 수 있도록 애니메이션 리타겟 기능을 제공한다.
- [관련 링크](http://bit.ly/ue4retargetvideo)

## 애니메이션 몽타주

## 그외
- c++의 auto 키워드를 사용하면 컴파일러에서 자동으로 타입 추론을 하게 된다.
```C++
auto number1 = 10;
```
- ::IsValid(UObject* object): 유효한 객체인지를 검사.
- Cast<T>: 언리얼 객체를 safety한 동적 형변환을 해주는 함수(?)
- APawn::GetVelocity: 폰의 현재 속도를 FVector로 반환하는 함수.
- 애님 그래프의 연결은 Alt 누른 상태에서 클릭하면 끊을 수 있따.
- 애니메이션 블루 프린트의 애님 그래프는 스테이트 머신 기능을 제공한다.
- 애니메이션 블루 프린트의 애니메이션 재생 노드에서 Loop 설정을 할 수가 있다.